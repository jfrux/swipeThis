/* 

                        swipeThis v0.7.3 jQuery Plugin

  author: Fortes [at] noumeni.us

  Released under the GNU licence

Dependencies
  jQuery 

Configuration Options:
  
  Multiple (default: false)
  fillContainer (default: true)
  fullScreen (default: false)
  itemWidth (default: 170)
  itemHeight (default: 140)
  indicator : Image url for the icon that tells users to swipe (default:'')
  marginRight: Margin applied to items in Multiple mode (default: 0)
  speed: Transition speed (default: 100)
  easein: jQuery easeIn function (default: '')
  tolerance: (default: 0.5)

*/(function(e){function a(e,t,n){n.fullScreen?(t.width=screen.width,t.height=screen.height):n.fillContainer?(t.width=e.parent().width(),t.height=e.parent().height()):(t.width=parseInt(n.itemWidth),t.height=parseInt(n.itemHeight))}function f(n,r,i){n.find("li").each(function(){var n=e(this);n.css("height",r.height),n.css("width",r.width),n.css("min-height",parseInt(i.itemHeight)+"px"),n.css("marginRight",i.marginRight+"px");var s=n.find("img");s&&(s.load(function(){var e,n,o,u,a,f;e=s.width,n=s.height,i.fillContainer?(o=r.width,u=o/e*n):e/r.width<n/r.height?(o=r.width,u=o/e*n):(u=r.height,o=u/r.height*e),a=(r.height-u)/2,f=(r.width-o)/2,s.css({"margin-top":a+"px","margin-left":f+"px",height:u+"px",width:o+"px"}),t&&console.log("EndimgResize:"+s.attr("src")+"("+o+","+u+")")}),s.complete&&s.trigger("load"))})}function l(e,n,r){var i=e.parent(),s=i.children(".swipeArea");a(i,n,r),f(e,n,r);if(r.multiple){var o=i.parent().width(),u=n.width+r.marginRight;s.width(o),n.visible=parseInt(o/u)}else s.width(n.width+r.marginRight),n.visible=1;s.css("min-height",parseInt(r.itemHeight)+"px"),s.height(n.height),t&&s.css("border","2px solid red"),e.width(n.count*(n.width+r.marginRight)),n.active=n.active+n.visible>=n.count?n.count-n.visible:n.active,e.animate({left:-n.active*(n.width+r.marginRight)},r.speed,r.easein);var l=i.children(".swipeIndicator");if(l.has(":visible").lenght!=0){var c;r.multiple?c=parseInt(i.parent().width()-48):c=parseInt(n.width-48);var h=parseInt(n.height/2-24);l.css({"margin-top":h+"px","margin-left":c+"px"})}}var t=!1,n="ontouchstart"in document.documentElement,r="touchmove scroll",i=n?"touchstart":"mousedown",s=n?"touchend":"mouseup",o=n?"touchmove":"mousemove";touchResizeEvent=n?"orientationchange":"resize";var u={init:function(r){return this.each(function(){var u=e(this);data=u.data("swipeThis");if(data)return;var a={multiple:!1,fillContainer:!0,fullScreen:!1,indicator:"",itemHeight:140,itemWidth:170,marginRight:0,speed:100,easein:"",tolerance:.5};r&&e.extend(a,r);var f={count:u.children().length,visible:0,active:0,height:0,width:0},c={touching:!1,x:0,xOffset:0};u.wrap('<div class="swipeThis"/>');var h=u.parent();h.prepend('<div class="swipeArea"/>');var p=h.children(".swipeArea");l(u,f,a);if(a.indicator!=""){h.children(".swipeIndicator").remove();var d;a.multiple?d=parseInt(h.parent().width()-48):d=parseInt(f.width-48);var v=parseInt(f.height/2-24);p.after('<div class="swipeIndicator" style="z-index:100;pointer-events: none;position: absolute; margin-left: '+d+"px;"+"margin-top: "+v+'px;">'+'<img src="'+a.indicator+'" border="0" alt=""/>'+"</div>")}e(window).bind(touchResizeEvent,function(e){if(u.has(":visible").length!=0){var t=u.data("swipeThis");t&&(l(u,t.items,t.settings),u.data("swipeThis",{items:t.items,settings:t.settings}))}}),p.bind(i,function(e){t&&console.log("touchStart");if(!c.touching){var n=e.originalEvent.touches?e.originalEvent.touches[0]:e;c.touching=!0,c.x=n.pageX}return!1}),p.bind(o,function(e){if(c.touching){var t=e.originalEvent.touches?e.originalEvent.touches[0]:e;c.xOffset=t.pageX-c.x,u.css("left",-f.active*(f.width+a.marginRight)+c.xOffset)}return!1}),p.bind(s,function(n){t&&console.log("touchEnd - xOffset:"+c.xOffset),c.touching=!1;if(!c.xOffset){t&&console.log("Tap/Click Event");var r=n.originalEvent.changedTouches?n.originalEvent.changedTouches[0]:n;return u.children("li").each(function(){var t=e(this),n=t.find("a");if(n.attr("href")!=undefined){var i=r.pageX,s=r.pageY,o=t.offset(),u=t.width(),a=t.height();i>o.left&&i<o.left+u&&s>o.top&&s<o.top+a&&n.click()}}),!1}var i=parseInt(f.width),s=1;a.multiple&&(s=Math.abs(parseInt(c.xOffset/i))+1);var o=i/2-i*a.tolerance;return-c.xOffset>o?(f.active+=s,f.active=f.active+f.visible>=f.count?f.count-f.visible:f.active):c.xOffset>o&&(f.active-=s,f.active=f.active<0?0:f.active),u.animate({left:-f.active*(f.width+a.marginRight)},a.speed,a.easein),a.indicator&&u.children(".swipeIndicator").css("display")!="none"&&e(".swipeIndicator").hide(),c.xOffset=0,!1}),n||p.mouseleave(function(e){c.xOffset&&p.mouseup()}),u.data("swipeThis",{items:f,settings:a})})},reposition:function(){return this.each(function(){var t=e(this);data=t.data("swipeThis"),data&&(l(t,data.items,data.settings),t.data("swipeThis",data))})},destroy:function(){return this.each(function(){var t=e(this),n=t.data("swipeThis");e(window).unbind(".swipethis"),t.removeData("swipeThis")})}};e.fn.swipeThis=function(t){if(u[t])return u[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return u.init.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.swipeThis")}})(jQuery);